# 開発の手引き

Tellorcheにおける開発ガイドです

## 着手前にIssueを立てる

もしそのタスクがある程度大きなモノなら、いきなりPull Requestを作らずにまずはIssueを起票しましょう。  
他のメンバーにも問題を可視化することで、アイデアが共有され思わぬ手戻りを防いだりすることができます。

もちろん対応するIssueがあるなら、それを自身が担当する旨を`Assign`機能を使って明示してください。  
自分が担当する旨をコメントしておくと、より丁寧ですね。


## ブランチを作る

原則として、コミットを直接`master`ブランチへpushすることは禁止です。  
Pull Requestを作ることで変更を可視化すること、コードレビューを実施することでバグを抑制するためです。  
必ず別のブランチを作り、その中で変更をコミットしてください。

このリポジトリへpushする権限を持っているなら、forkせずに直接ブランチを作成して構いません。  
ただし、他のメンバーとのブランチ名重複を防ぐため、以下を参考にしてください。

- 作成するブランチ名は `#{あなたの識別子}/#{一意な識別子}` の形式  
  - たとえば、`shuma/fix-readme-mistake`のような形式です。
- 既に利用したことのあるブランチ名は極力避ける
- 必ず最新の`master`を`pull`し、そこを起点に作る

コマンドに落とし込むと、例えば以下のようになるでしょう:

```sh
pwd
# /Users/shuma/Documents/tellorche
git checkout master
# Already on 'master'
# Your branch is up to date with 'origin/master'.
git pull
# Already up to date
git checkout -b 'shuma/fix-readme-mistake'
# Switched to a new branch 'shuma/fix-readme-mistake'
```

## 完了前でも`WIP`のPull Reqestを作る

自身が現在どんな作業をしているのか、他のメンバーにもわかる状態にしましょう。  
小さく変更をしてコミットを作成し、その状態でまずはPushします。  
または、初めに "空のコミット" を作成するのも良いでしょう。例えば以下のように行います:

```sh
pwd # /Users/shuma/Documents/tellorche
git commit -m '○○作業の着手' --allow-empty
# [shuma/fix-readme-mistake *******] ○○作業の着手
git push
```

この状態でGitHub.com上でリポジトリを開き、`Pull requests`タブを確認すれば、自身の作ったブランチ名で`Compare & pull request`ボタンが表示されるはずです。

もし完了していない作業中のプルリクであれば、タイトルの先頭に`[WIP]`と付けるのをお忘れなく。`Work In Progress (作業中)`の意を示しておけば、誰かが勝手にマージしてしまうのを防ぐことができます。

## こまめにCommit & Pushする

小さな変更をするたびにコミットし、プッシュするように心掛けましょう。  
もし自身の修正にミスがあった場合、プルリクを見ている他のメンバーが早期に指摘してくれる場合があります。

## 作業が完了したら、WIPを外してレビュー依頼する

作業が完了した旨を示すため、プルリクの`Edit`ボタンを押してタイトルの先頭から`[WIP]`を外しましょう。もしこれが付与されたままの場合、マージできないようになっています。  
次に誰かへ自分の変更に対するコードレビューを依頼してください。プルリク右側の`Reviewers`からリクエストできます。  
コードレビュー時にはメンション (アットマーク+IDによる他のユーザへの返信) をコメントで送ったり、口頭で伝えるなど、別途リクエストした旨を通知するとより丁寧ですね。

## 依頼されたら、コードレビューをする

これはコードレビューをする側です。ファイルの変更内容をチェックし、動作確認をして、変更を受け入れるか判断してください。  
OKなら`Files changed`タブにある`Review Changes`ボタンから`Approve`を押すようにしましょう。

もちろん変更が必要な箇所があれば、提案を書いた上で `Request Changes` を選択してください。

このリポジトリでは、最低1人以上のレビューが無いとマージできない設定にしています。

## マージする

レビューが返ってきて、必要な修正が完了し、最終的にApproveしてもらえたら、プルリクエストを**担当者自身の手で**マージしてください。
