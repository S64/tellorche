task clean(type:GradleBuild) {
    tasks = ['cleanMasterApp', 'cleanEsp32Controller']
}

task buildMasterApp(type:Exec) {
    workingDir './master'
    commandLine './gradlew', 'shadowJar'
}

task cleanMasterApp(type:Exec) {
    workingDir './master'
    commandLine './gradlew', 'clean'
}

task printCommandLineMasterApp {
    doLast {
        println 'java -jar ./master/build/libs/tellorche-master-app.jar --config ./tellorcheconfig.example.json'
    }
}

task buildEsp32Controller(type:Exec) {
    workingDir './controllers/esp32'
    commandLine 'platformio', 'run', '--environment', 'esp32dev'
}

task cleanEsp32Controller(type:Exec) {
    workingDir './controllers/esp32'
    commandLine 'platformio', 'run', '--environment', 'esp32dev', '--target', 'clean'
}

task printCommandLineUploadEsp32Controller {
    doLast {
        println 'platformio run --project-dir ./controllers/esp32 --environment esp32dev --target upload --upload-port ${YOUR_ESP32_PORT}'
    }
}
